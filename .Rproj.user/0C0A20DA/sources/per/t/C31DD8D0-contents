library(tidyverse)
download.file('https://github.com/hannesdatta/course-dprep/raw/master/content/docs/modules/week4/tutorial/data_without_duplicates.zip', 'data.zip')
unzip('data.zip')
dataser <- read_csv("streams.csv")
?read_csv

summary(streams)

colnames(streams)


library(tidyverse)
streams <- read_csv('streams.csv')
songs <- read_csv('songs.csv')
countries <- read_delim('country_codes.csv', ';')
streams %>% filter(country == "BE")

streams %>% arrange(desc(streams))

songs
songs %>% filter(song_id ==21831898)


streams %>% mutate(revenue = .0038 * streams)



songs %>% group_by(artists) %>% summarise(count=n()) %>% arrange(desc(count))

#summing up the streams by song under streams2
streams2 <- streams %>% group_by(song_id) %>% summarise(totstreams = sum(streams))

#Create a new dataset, called artists, showing the count of songs by artist.

artists = songs %>% group_by(artists) %>% summarise(totartists= summarise(songs))

songs %>% count(artists) %>% filter(artists=='Ellie Goulding')

songs %>% count(artists) %>% filter(grepl('Ellie Goulding', artists, ignore.case=T))


#merging

