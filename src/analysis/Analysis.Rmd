---
title: "Examining the Influence of Film Directors on Movie Opening Gross"
output:
  pdf_document: default
  PDF: default
date: "2023-10-05"
---
#Newly created variables
In deze analyse zal gekeken worden naar het effect dat de regisseur van een film heeft op de openinggross van een film. Hiervoor zal de bekendheid van een regisseur moeten worden gemeten. Om dit meetbaar te maken zijn de variabelen "director_count" en "directed_above_median" gecreeÃ«rd. Met de director_count wordt gemeten hoevaak een regisseur een film heeft geregisseerd die in de 843 films met de hoogste openinggross staat. Daarnaast geeft de variabele "directed_above_median" aan of een regisseur meer films heeft geregisseerd dan den mediaan. Als dit er meer zijn dan de mediaan wordt dit gezien als een bekende regisseur.
```{r setup}
library(readr)
# import dataset
movie_director_data <- read_csv("data/movie_director_data.csv")
movie_director_data <- na.omit(movie_director_data)

# make openninggross a numeric variable and remove dollar signs
movie_director_data$openinggross <- as.numeric(gsub("[\\$,]", "", movie_director_data$openinggross))

# Make runTimeMinutes a dummy variabele by using a median split
  # Calculate median of variable 'runtimeMinutes'
median_runtime <- median(movie_director_data$runtimeMinutes)

movie_director_data$runtime_dummy <- ifelse(movie_director_data$runtimeMinutes <= median_runtime, 0, 1)

# Count how many times a director has directed a movie that is in the dataset
movie_director_data$director_count <- ave(movie_director_data$director_identifier, movie_director_data$director_identifier, FUN = length)

median_director_count <- median(movie_director_data$director_count)
movie_director_data$directed_above_median <- ifelse(movie_director_data$director_count <= median_runtime, 0, 1)

```

#Utilized models
##T-test
Firstly, we conduct a t-test to examine whether there is a significant difference in the means of the "directed_above_median" groups concerning opening gross.
```{r}
# T-test + Barplot to make the t-test visual
  # T-test with openinggross DV and director_above_median IV
t_test_result <- t.test(openinggross ~ directed_above_median, data = movie_director_data)
print(t_test_result)

# Bereken de gemiddelde Opening Gross per groep
means <- tapply(movie_director_data$openinggross / 1e6, movie_director_data$directed_above_median, mean)

# Maak een staafdiagram
barplot(means, 
        names.arg = c("Directed Below Median", "Directed Above Median"),
        ylab = "Mean Opening Gross in Millions of dollars",
        xlab = "Directed Above Median Runtime",
        col = c("blue", "red"),
        main = "Mean Opening Gross by Directed Above Median Runtime",
        ylim = c(0, 70))  # Beperk de y-as tot 0-70

# Voeg een legenda toe
legend("topright", legend = c("Directed Below Median", "Directed Above Median"), fill = c("blue", "red"))

```

## Lineair regression
Om te achterhalen of het verschil in de gemiddelde van de groepen in de t-test wordt veroorzaakt door de variabele "directed_above_median" wordt een lineaire regressie gedaan. Hierin worden de variabelen "theaters" en "runtime_dummy" ook meegenomen. 

```{r pressure}
# Regression analysis
openinggross_lm1 <- lm(openinggross ~ theathers + directed_above_median + runtime_dummy, movie_director_data)
summary(openinggross_lm1)
```

#Conclusion
Looking at the results, we clearly observe a difference in the two means between the opening gross of films directed by directors with higher recognition (directed_above_median = 1) against directors with a lower recognition (directed_above_median = 0), and this difference is statistically significant. However, upon reviewing the results of the linear regression, it becomes apparent that this outcome is predominantly driven by other variables. By including the variables "theaters" and "runtime_dummy," we observe that the p-value for the variable "directed_above_median" becomes non-significant. The remaining variables in this model maintain their significance. Therefore, based on this dataset, it cannot be concluded that the director of a film has a significant impact on the opening gross of a film.
